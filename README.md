
### Introduction
For our final project, we employed the wines dataset, which gauges the quality of red and white wines through an array of qualitative attributes such as alcohol content, sugar content, and pH levels, among others. The overall study focuses on two datasets featuring variations of white and red vinho verde samples from Portugal, compiled by Paulo Cortez and his team in 2009. It was curated via physicochemical examinations aimed at quantifying the properties of distinct wine samples in relation to a numerical metric denoting 'wine quality' (the response variable). Comprising 12 variables in total, excluding 'wine quality', the dataset is composed of 11 input variables noted below:

It is imperative to highlight the presence of redundancy among certain variables and the continuous nature of the dataset. Additionally, the dataset comprises two distinct tables delineating red and white wine samples while maintaining identical features. In totality, the dataset comprises 4,898 samples of white wine and 1,599 samples of red wine. Our project aims to narrow down our understanding of these variables and their impact on overall wine quality by utilizing statistical models. Our overarching goal is to be able to predict “quality” using its corresponding variables.

### Background 
Before diving into the comprehensive models constructed in aim of predicting wine quality, a moderate background research was done to gain an understanding of the variables measured in the dataset. 
Generally speaking, the fundamental attributes of wine come from the interaction of acidity, sugar, and alcohol. From usage of fixed/volatile acidity, acids are fundamental to wine’s flavor, stability, and color, it being critical for the wine's freshness and balance. These levels are adjusted through various methods of fermentation, contributing to the wine’s complexity in flavor but also its texture.

Residual sugar, the sugar remaining after fermentation, defines the sweetness level of the wine, from flat to sweet. Alcohol is produced during fermentation as yeast converts sugar into ethanol and carbon dioxide, where winemakers attempt to manage this balance in the fermentation process, sometimes stopping it early to retain more sugars for a sweeter wine. Primarily, the balance between sugar, alcohol, and acidity is pivotal in defining the style and natural complexity of wine. 

In addition to this, an assortment of particular chemicals such as chlorides and sulfides come into place. With it being present in lower concentrations, these salts can impact the wine's palatability and overall flavor profile. Lastly, sulfur dioxide is included in free and bound forms acting as an antioxidant and a preservative in wine. While they may naturally occur due to the fermentation process, additional sulfites can be added as a preservative.
With this in mind, we can use this information to analyze our data in regards to context and reasoning for future observations we make. 

### Data Exploration
The initial phase of data exploration involved the utilization of a correlation matrix visualization to delineate the correlation coefficients among various variables within the dataset. Each cell within this matrix delineates the correlation coefficient between the variables listed on the x-axis and those on the y-axis.
	
The correlation matrix for white wines, visualized through a pie heatmap, is shown:

This visualization reveals that the predictors—alcohol content, pH, and sulphates—are predominantly correlated with higher white wine quality values. In contrast, the majority of other variables exhibit a negative impact on white wine quality scores. Notably, attributes such as volatile acidity, fixed acidity, chlorides, and density seem to emerge as significant variables negatively influencing white wine quality.
The same methodology for data exploration was applied to the red wines dataset:

In the examination of the correlation matrix pertaining to red wines, we can observe a positive correlation between alcohol content and wine quality, paralleling observations made in white wines. Furthermore, sulphates exhibit an enhanced positive association with quality in red wines. Notably, a new positively influencing trait for red wines not seen in white wines is citric acid. A significant finding is that free sulfur dioxide exhibits a strong correlation with total sulfur dioxide, indicating that a considerable portion of sulfur dioxide in red wine exists in its free form—a relationship not observable in our white wine correlation matrix.
Broadly, both red and white wines exhibit similarities in the factors that influence quality; however, these factors impact the two wine types in varying ways - some features even conversely impacting. This comparison could point to the importance of differentiating between red and white wines in future models given its relatively differing responses to its chemical constituents in terms of overall quality scores.

### Principal Component Analysis
Because of the nuances splitting red and white wines, classification models were constructed to gain a more finetuned understanding of how the two types of wines interpret the variables differently and how they can be clustered.
Our first clustering visualization on the left, provides a broad view of the variability within white wines, suggesting intricate differences in their composition that are not as pronounced in red wines. The spread along both PC1 and PC2 for white wines indicates a complex interaction of features that influence their quality, aligning with earlier analyses where features like alcohol content and volatile acidity showed strong correlations with wine quality. This broader distribution in the PCA plot likely indicates the existence of the various physicochemical properties and their impact on the sensory characteristics and quality ratings of white wines. It is worthwhile to note that our white wines dataset had a greater number of samples, which is why we may observe a wide spread of features at first glance. 

To potentially validate or contradict these observations, we created another model but with select features ('sulphates', 'alcohol', 'citric.acid', 'volatile.acidity', 'total.sulfur.dioxide', 'density', 'residual.sugar', 'quality) - features that seemed to be prominent of impact on quality from our initial data exploration.

This clustering visualization was formed from selected chemical properties rather than utilizing all of the existent variables in the dataset as factors. Red wines cluster predominantly higher on PC2, possibly reflecting unique aspects of their chemical profiles such as higher levels of certain acids or preservatives that differentiate them from white wines. This matches up with their usage of acidity for preservation methods and may point towards the direction that the fermentation process for red wines may be more complex, making necessary of more external additions in an attempt to stabilize the fermentation process.

Moreover, the analysis indicates that factors such as volatile acidity and sulphates- both pivotal in modulating wine stability- play crucial roles in delineating the typology and perceived quality of wines. The compact clustering observed among the red wine samples seem to signify a lower degree of variability within this group, in contrast to the white wines, which exhibit a broader dispersion across the first principal component (PC1). This dispersal highlights a greater variability in the physicochemical attributes of white wines. These findings are consistent with the results from our initial data explorations and also from our first PCA exploration.

### Models: Linear Regression
A linear regression model was developed to predict the quality of red wines, incorporating all available predictors. The summary of this model, as displayed on the left, indicates a residual range from -2.52213 to 2.00517. This range highlights that while most predictions align closely with actual observations, as evidenced by the 1st and 3rd quartiles, some predictions deviate significantly.

To further assess the model's accuracy, the predicted values were plotted against the actual observations: 

The resulting visualization suggests suboptimal performance of the linear regression approach. This inference is supported by the ordinal and non-continuous nature of the "quality" response, which contradicts our initial assumptions of a continuous response. Thus, the use of linear regression may not be appropriate for this dataset. Given the ordinal nature of the quality variable, an alternative approach such as classification models could potentially align better with the inherent categorical characteristics of our non-continuous wine quality ratings.

### Red Wine Regression Trees with Pruning
White WineWhen examining the data with our multiple linear regression, we found that our data was stratified and may not have followed a necessarily linear relationship. In order to compensate for this, we turned to regression trees because they are inherently non-linear and section off prediction areas based on different feature values. After running cross-validation measures, the best number of terminal nodes for the red wines was eleven with alcohol, sulphates, volatile acidity, and total sulfur dioxide being used as the predictors for red wine quality. Meanwhile, for white wine, the selected predictors were alcohol, volatile acidity, free sulfur dioxide, and density with seven terminal nodes. Comparatively though, the red wine tree did slightly worse than the multiple linear regression having an average error of 0.4801827 while the white wines had an average error of 0.5797021, which was slightly lower than the linear regression model’s. When inspecting the trees, it seems that alcohol is an important indicator of quality as well as volatile acidity, as they were often the last decisions made before quality. This seems to match our prior research in that volatile acidity is often a sign of wine spoilage and that alcohol has to be finely balanced by the winemakers during the fermentation process. 

### Regression Trees with Bagging and Random Forests 
A problem with regression trees is that they are susceptible to high variance. This can lead to inaccurate results and predictions, which is why we turned to bagging and random forests. By having hundreds of trees, bootstrapping different subsets of features, and aggregating all of these trees’ predictions, we were able to lower the mean squared error by a significant margin. For the red wine regression trees, they showed that alcohol,  sulphates, and volatile acidity had the highest impacts on wine quality predictions with increases in node purity values of 231, 113, and 99 respectively. This method led to a MSE of 0.3461522 which is much lower than the previous tree as well as the regression model from before. With the white wines, alcohol, volatile acidity, free sulfur dioxide had the highest increases in node purity with values of 734, 370, and 350 and a mean squared error of 0.3719519 which is over a .2 decrease in error compared to other models. By using bagging and random forests to combat the high variance and overfitting of regression trees, we were able to find a model that could predict quality values within half of a single quality point, which is extremely valuable. 

### Conclusion

Before we delved into this project, we found it hard to agree with the fact that you could declare wine quality based on some chemical compound values since the quality of wine is such a subjective topic. Needless to say, though, we were able to find relationships between certain features that led us to within half a point in quality with some models. Unsurprisingly, regression trees supported by bagging and random forests led to the lowest mean squared errors for both the white and red wines, with values of 0.3719519 and 0.3461522, respectively. Meanwhile, the multiple linear regression models had mean squared errors of 0.580647, for white wines, and 0.4264839 for red wines. Comparatively, regression trees with bagging and random forests tended to perform better because of the seemingly non-linear relationship between the features and quality. We could see that when graphing our linear regression model and seeing how stratified the data was because quality only took whole number values. 

The relationship between features was also complex and it may have been difficult for a linear regression model to find these deeper non-linear relationships that the hundreds of trees tried over a large number of unique subsets of features could find. Ensemble methods also prove more resistant to outliers and noise, which may have affected the predictions from the multiple linear regression model. This could be largely attributable to the non-linear relationships captured by these ensemble methods, which are adept at illustrating the interactions between features that linear models typically overlook. 
The implications of our findings can be evident from the fact that statistical models can provide insights into a historically rich artisan that has taken generations to develop. However, the interactions between the physiochemical properties of wine are extraordinarily complex with statistical models bounding the limitations of the minute details of the fermentation process of wine. Conclusively, a conjunction between our past expertise of wine fermentation and statistical models is far preferable, and could potentially positively impact the future of wine production. 